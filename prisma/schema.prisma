generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
}

// Enums
enum UserRole {
  SUPERADMIN
  WRITER
  EXTERNAL
}

enum ArticleStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String // Hashed password
  name      String?
  role      UserRole @default(SUPERADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  articles Article[]

  @@map("users")
}

model Category {
  id        String   @id @default(uuid())
  name      String   @unique
  slug      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  articles Article[]

  @@map("categories")
}

// Articles
model Article {
  id          String        @id @default(uuid())
  title       String
  slug        String        @unique
  excerpt     String?
  content     String        @db.Text // Rich text HTML from Quill
  coverImage  String?
  author      String
  status      ArticleStatus @default(DRAFT)
  views       Int           @default(0)
  tags        String[] // Array of tag strings
  publishedAt DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  // Foreign Keys
  categoryId String?
  userId     String?

  // Relations
  category Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  user     User?     @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([status])
  @@index([categoryId])
  @@index([userId])
  @@index([publishedAt])
  @@map("articles")
}

// Partnership Applications
model Partnership {
  id          String   @id @default(uuid())
  name        String // Full name
  institution String // Institution/Company
  email       String // Email address
  subject     String // Subject line
  message     String   @db.Text // Message content
  filePath    String? // Optional uploaded file path
  nda         Boolean  @default(false) // Non-Disclosure Agreement
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("partnerships")
}

// Alumni Records
model Alumni {
  id        String   @id @default(uuid())
  name      String // Full name
  email     String   @unique // University email
  institution String // Institution
  phone     String // Personal phone number
  position  String // Current position
  message   String   @db.Text // Message
  photoPath String? // Uploaded photo file path
  isNewData Boolean  @default(true) // true = New Data, false = Update Data
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("alumni")
}
